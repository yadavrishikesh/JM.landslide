% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/other-supporting-functions.R
\name{dtgGPD}
\alias{dtgGPD}
\title{Density Function of Mixture of Truncated Gamma and GPD Distribution}
\usage{
dtgGPD(x, u.thr, k, xi, sigma, sigma.GP, thr.prob, log = TRUE)
}
\arguments{
\item{x}{A numeric vector of quantiles at which the density function is evaluated.}

\item{u.thr}{A numeric value specifying the threshold. Values of \code{x} less than \code{u.thr} follow the truncated Gamma distribution, and those greater than \code{u.thr} follow the GPD.}

\item{k}{A positive numeric value representing the shape parameter of the truncated Gamma distribution.}

\item{xi}{A numeric value representing the shape parameter of the GPD.}

\item{sigma}{A numeric vector or value specifying the scale parameter of the truncated Gamma distribution.}

\item{sigma.GP}{A positive numeric value representing the scale parameter of the GPD.}

\item{thr.prob}{A numeric value in (0, 1) specifying the probability mass of the GPD part in the mixture.}

\item{log}{Logical; if \code{TRUE}, the logarithm of the density is returned.}
}
\value{
A numeric vector of the same length as \code{x}, containing the (log) density values of the mixture distribution at the specified quantiles.
}
\description{
This function computes the density of a distribution that is a mixture of a truncated Gamma distribution and a Generalized Pareto Distribution (GPD).
The mixture model has a probability mass defined by \code{thr.prob} at the threshold \code{u.thr}, below which the distribution follows a truncated Gamma, and above which it follows a GPD.
}
\details{
The mixture distribution is defined as follows:
\itemize{
\item For \eqn{x < u.thr}, the density follows a truncated Gamma distribution with shape parameter \eqn{k}, scale parameter \eqn{\sigma}, and support in \eqn{(0, u.thr)}.
\item For \eqn{x \geq u.thr}, the density follows a Generalized Pareto Distribution (GPD) with shape parameter \eqn{\xi}, scale parameter \eqn{\sigma.GP}, and location \eqn{u.thr}.
\item The mixing probability \eqn{thr.prob} controls the weight of the GPD part in the overall distribution.
}
}
\examples{
# Example usage of the dtgGPD function
set.seed(123)
x <- seq(0, 10, by = 0.1)
u.thr <- 5
k <- 2
xi <- 0.5
sigma <- 1
sigma.GP <- 0.8
thr.prob <- 0.3
dens <- dtgGPD(x, u.thr, k, xi, sigma, sigma.GP, thr.prob, log = FALSE)
plot(x, dens, type = "l", main = "Density of Mixture of Truncated Gamma and GPD", ylab = "Density", xlab = "x")
}
\seealso{
\code{\link[evd]{dgpd}} for the density of the standard GPD,
\code{\link{dgammat}} for the density of the truncated Gamma distribution.
}
