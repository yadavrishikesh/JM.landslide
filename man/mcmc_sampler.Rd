% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main-mcmc_sampler.R
\name{mcmc_sampler}
\alias{mcmc_sampler}
\title{MCMC Sampler for Joint Spatial Modeling of Landslide Counts and Sizes}
\usage{
mcmc_sampler(
  Y,
  A,
  Z1,
  Z2,
  CV,
  mark_dist,
  thr.family,
  model_type,
  adjacensy,
  q.probs = as.numeric(quantile(sqrt(A), probs = seq(0.5, 0.99, 0.05))),
  q.probs.thr = 0.83,
  no.rm.obs = 2000,
  N.MCMC = 20000,
  model.base = FALSE,
  tun.hyper.mu = 0.01,
  tun.hyper.GP = 0.01,
  tun.eta = 1,
  tun.mu = 1,
  thin = 10,
  adapt = 100,
  burn_in1 = NULL,
  burn_in2 = NULL,
  true.values = NULL,
  simulation = FALSE,
  print.result = TRUE,
  traceplot = FALSE,
  samples.store,
  init.seed = NULL
)
}
\arguments{
\item{Y}{A vector of length \code{n} containing landslide count data.}

\item{A}{A vector of length \code{n} containing landslide size data corresponding to the landslide counts.}

\item{Z1}{A design matrix of dimension \verb{n x p} consisting of covariates used in the log-linear predictor of counts.}

\item{Z2}{A design matrix of dimension \verb{n x q} consisting of covariates used in the log-linear predictor of sizes.}

\item{CV}{A character string specifying the type of cross-validation. Two choices:
\itemize{
\item \code{"OOS"}: Out-of-sample cross-validation.
\item \code{"WS"}: Within-sample assessment.
}}

\item{mark_dist}{A character string specifying the distribution type for landslide sizes. Three choices:
\itemize{
\item \code{"eGPD"}: Extended Generalized Pareto Distribution.
\item \code{"bGPD"}: Beta-GPD mixtures.
\item \code{"tgGPD"}: Truncated gamma-GPD mixtures.
}}

\item{thr.family}{A character string specifying the distribution used to estimate the non-stationary thresholds of landslide sizes. Only used when \code{mark_dist} is \code{"bGPD"} or \code{"tgGPD"}. Two choices:
\itemize{
\item \code{"gamma"}: Gamma distribution.
\item \code{"logNormal"}: Log-normal distribution.
}}

\item{model_type}{A character string specifying the type of model. Two choices:
\itemize{
\item \code{"FE"}: Fixed effects model.
\item \code{"jSp"}: Joint spatial model.
}}

\item{adjacensy}{A matrix or list specifying the adjacency structure of the slope units for the spatial model.}

\item{q.probs}{A numeric vector of quantiles at which to calculate the landslide risk. Default is \code{quantile(sqrt(A), probs = seq(0.50, 0.99, 0.05))}.}

\item{q.probs.thr}{A numeric vector specifying the threshold quantiles to extract threshold exceedances. Default is \code{0.83}.}

\item{no.rm.obs}{The number of observations randomly removed when performing the out-of-sample (OOS) experiment.}

\item{N.MCMC}{An integer specifying the number of MCMC samples. Default is \code{2e4}.}

\item{model.base}{A logical value. If \code{TRUE}, sets \code{beta = 0}, indicating that counts and sizes are modeled as independent of each other. Default is \code{FALSE}.}

\item{tun.hyper.mu}{A numeric value for the tuning parameter of the normal Metropolis-Hastings steps when updating the hyperparameters for \code{mark_dist}.}

\item{tun.hyper.GP}{A numeric value for the tuning parameter of the normal Metropolis-Hastings steps when updating the hyperparameters for the generalized Pareto distribution.}

\item{tun.eta}{A numeric value for the tuning parameter of the normal Metropolis-Hastings steps when updating the log-linear predictor \code{eta}.}

\item{tun.mu}{A numeric value for the tuning parameter of the normal Metropolis-Hastings steps when updating the log-linear predictor \code{mu}.}

\item{thin}{An integer specifying the thinning interval used in the MCMC. Default is \code{10}.}

\item{adapt}{An integer specifying the number of samples after which to perform adaptive MCMC. Default is \code{100}.}

\item{burn_in1}{The first burn-in period of MCMC samples. If not specified, it defaults to \code{N.MCMC / 4}.}

\item{burn_in2}{The second burn-in period of MCMC samples. If not specified, it defaults to \code{N.MCMC / 2}.}

\item{true.values}{A named list or vector of the true parameter values, used only for simulation experiments.}

\item{simulation}{A logical value. If \code{TRUE}, a simulation experiment is conducted; otherwise, real data experiments are performed. Default is \code{FALSE}.}

\item{print.result}{A logical value. If \code{TRUE}, results are printed at fixed numbers of iterations. Default is \code{TRUE}.}

\item{traceplot}{A logical value. If \code{TRUE}, visual traceplots are shown as the MCMC progresses. Default is \code{FALSE}.}

\item{samples.store}{An integer specifying the number of samples stored for calculating summary statistics (e.g., QQ-plots, uncertainty quantification).}

\item{init.seed}{An optional integer specifying the initial seed for random number generation to ensure reproducibility.}
}
\value{
A list containing results of the MCMC sampling, including estimated parameters, risk quantiles, and any diagnostics.
}
\description{
Implements an MCMC sampler for the joint modeling of landslide count data and landslide size data, as described in the book chapter by Yadav et al. (2024), "Statistics of Extremes for Natural Hazards: Landslides and Earthquakes." The function allows for various covariate inputs, cross-validation types, and distributional assumptions, offering flexibility for both real data analysis and simulation experiments.
}
\examples{
\dontrun{
# Example usage
mcmc_sampler(Y = count_data, A = size_data, Z1 = covariates_counts, Z2 = covariates_sizes,
             CV = "OOS", mark_dist = "eGPD", thr.family = "gamma", model_type = "jSp",
             adjacensy = adj_matrix, q.probs = seq(0.50, 0.99, by = 0.05),
             N.MCMC = 20000, simulation = TRUE, init.seed = 123)
}
}
